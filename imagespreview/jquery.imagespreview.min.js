(function(b){var e=function(j,e){var a=this,f=5,g=null,h=function(){g=setInterval(function(){f--;1>f&&(a.hidePageButton(),a.hideButton.animate({opacity:"hide"},a.settings.speed,"swing"),window.clearInterval(g))},1E3)};this.list=j;this.id="images-preview-fullscreen-"+Math.random().toString().replace(".","").substr(0,12);this.settings=b.extend(!0,{},b.fn.imagespreview.defaults,e);this.tpl='<div id="'+this.id+'" class="images-preview-fullscreen-ct"><div class="cover-bg"></div><div class="show-ct"><div class="loader"></div><a class="hide-bt" href="javascript:void(0);"></a><a class="prev-bt preview-page-bt" href="javascript:void(0);"><span class="str"></span></a><a class="next-bt preview-page-bt" href="javascript:void(0);"><span class="str"></span></a><img class="curr-pic" src="" /></div><div class="previews-list"></div></div>';
this.loader=this.hideButton=this.nextButton=this.prevButton=this.cover=this.container=this.curr=null;this.requestFullscreen=function(a){a.requestFullScreen?a.requestFullScreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullScreen&&a.webkitRequestFullScreen()};this.cancelFullscreen=function(){document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen()};this.loadPreview=
function(c){var d=this.container.find(".curr-pic"),f=d.width(),j=d.height(),g=""==this.settings.src?c.attr("src"):c.data(this.settings.src),c=b("<img />");this.loader.show();c.load(function(){if(b.isFunction(a.settings.loadCallback)&&!1===a.settings.loadCallback(this))return!1;a.loader.hide();var c=b(this)[0].width,e=b(this)[0].height,k=c,i=e,h=a.container.find(".show-ct").height();e>h&&(i=h,k=c/e*i);d.css({width:f,height:j}).fadeTo(0,0).animate({width:k,height:i,marginTop:-1*(i/2),marginLeft:-1*
(k/2),opacity:1},a.settings.speed,"swing").attr("src",g)}).attr("src",g)};this.init=function(){this.container=b(this.tpl);this.cover=this.container.find(".cover-bg");this.loader=this.container.find(".loader");this.prevButton=this.container.find(".prev-bt");this.nextButton=this.container.find(".next-bt");this.hideButton=this.container.find(".hide-bt");this.container.appendTo("body");1<this.list.size()&&(this.prevButton.on("click",function(){var c=a.list.index(a.curr);if(0>c-1){if(b.isFunction(a.settings.firstCallback)&&
!1===a.settings.firstCallback(a))return!1;a.curr=a.list.last()}else a.curr=a.list.eq(c-1);a.loadPreview(a.curr)}),this.nextButton.on("click",function(){var c=a.list.index(a.curr);if(c>=a.list.size()-1){if(b.isFunction(a.settings.lastCallback)&&!1===a.settings.lastCallback(a))return!1;a.curr=a.list.first()}else a.curr=a.list.eq(c+1);a.loadPreview(a.curr)}),b(document).on("keydown.imagespreviewevent",function(c){c=event||window.event;c=c.keyCode||c.which;37==c&&a.prevButton.trigger("click");39==c&&
a.nextButton.trigger("click")}));this.hideButton.on("click",function(){if(b.isFunction(a.settings.hideCallback)&&false===a.settings.hideCallback(a))return false;a.hidePreview();a.settings.hideType=="close"&&a.close()});h();b(document).on("mousemove.imagespreviewevent mouseclick.imagespreviewevent keydown.imagespreviewevent",function(){if(f<1){a.showPageButton();a.hideButton.animate({opacity:"show"},a.settings.speed,"swing");h()}f=a.settings.hideTimeout});b.isFunction(this.settings.initCallback)&&
this.settings.initCallback(this);return this};this.setCurr=function(a){var d=0;b.isNumeric(a)?(a=Math.floor(a),d=a>this.list.size()||0>a?0:a):b.isEmptyObject(a)||(d=this.list.index(a));this.curr=this.list.eq(0>d?0:d);return this};this.hidePreview=function(c){b("html,body").css({overflow:"auto"});"fullScreen"==a.settings.showType&&a.cancelFullscreen();setTimeout(function(){a.hidePageButton();a.container.find(".curr-pic").animate({width:0,height:0,marginTop:0,marginLeft:0,opacity:"hide"},a.settings.speed,
"swing");a.cover.animate({opacity:0},a.settings.speed,"swing",function(){a.container.css({display:"none"});b.isFunction(c)&&c(a)})},200)};this.showPageButton=function(){a.prevButton.find(".str").css({left:-1*a.prevButton.find(".str").width()}).animate({left:0,opacity:"show"},this.settings.speed,"swing");a.nextButton.find(".str").css({right:-1*a.nextButton.find(".str").width()}).animate({right:0,opacity:"show"},this.settings.speed,"swing")};this.hidePageButton=function(){a.prevButton.find(".str").animate({left:-1*
a.prevButton.find(".str").width(),opacity:"hide"},this.settings.speed,"swing");a.nextButton.find(".str").animate({right:-1*a.nextButton.find(".str").width(),opacity:"hide"},this.settings.speed,"swing")};this.show=function(){"fullScreen"==this.settings.showType&&this.requestFullscreen(document.documentElement);this.cover.animate({opacity:this.settings.opacity},this.settings.speed,"swing",function(){2>a.list.size()?a.hidePageButton():a.showPageButton()});b("html,body").css({overflow:"hidden"});this.container.css({display:"block"});
this.curr||(this.curr=this.list.first());this.loadPreview(this.curr);return this};this.hide=function(){if(b.isFunction(a.settings.hideCallback)&&!1===a.settings.hideCallback(a))return!1;this.hidePreview();return this};this.close=function(){this.hidePreview(function(){if(b.isFunction(a.settings.closeCallback)&&!1===a.settings.closeCallback(a))return!1;b(document).off(".imagespreviewevent");window.clearInterval(g);a.container.remove();a=null})}};b.fn.imagespreview=function(b){return new e(this,b)};
b.fn.imagespreview.defaults={showType:"fullScreen",hideType:"close",src:"",speed:"slow",hideTimeout:5,opacity:0.9,loadCallback:b.noop,initCallback:b.noop,hideCallback:b.noop,closeCallback:b.noop,firstCallback:b.noop,lastCallback:b.noop}})(jQuery);
